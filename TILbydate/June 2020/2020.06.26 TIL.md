# 2020.06.26 Honux 수업

## Docker

* 컨테이너가 생성되고 나서 별로 물건의 보관에 신경쓰지 않아도 된다.
* 경량 컨테이너
  * 비경량 컨테이너: 가상머신
  * 차이가 무엇일까?
    * 비경량 컨테이너는 가상 머신/가상 하드웨어를 설치하고 위에 앱을 설치해서 돌린다. 느리네.
    * 가상 머신은 가상 하드웨어를 거쳐서 운영체제를 거쳐서 진짜 하드웨어에 접근한다.
    * 하드웨어 버추얼라이제이션 테크놀로지. 허가받은 앱들에 따라서 직접 뚫어주니 빠르다.
      * 운영체제 툴셋 설치하면 빨라지는 이유. 인텔 칩 vs 애플 실리콘
    * 하드웨어에서 가상화를 지원 (CPU 단에서 VT 지원여부 확인 필요)
    * HyperVisor는 VB와 App을 연결해주는 계층
    * Docker는 App을 "얇은 레이어로" 연결해준다. 상당히 가볍다.
    * 가상머신 안에는 가상머신을 설치할 수 없지만, 도커 안에는 도커를 설치할 수 있다!
  * 윈도우건 맥이건 똑같은 배포 환경을 제공하므로 매우매우 구동이 잘 된다!
* Docker Hub
  * 도커 이미지들의 저장소
  * MySQL, Git의 명령어를 많이 가져왔다.
  * 바이너리 파일 형태 하나로 저장하는 것이 아니라 이미지를 쪼갠 파일의 조합으로 구성된다.
  * docker run 명령어를 실행하면...
    * local에서 찾아본다.
    * 없으면 Docker Hub에서 가져온다.
  * 실행하는 프로그램을 죽이면 이미지도 같이 죽는다.
* busybox는 임베디드 리눅스 중 가장 가벼운 리눅스의 명령어를 모아둔 것이다.
  * docker 컨테이너 명령어를 실행할 때 이미지 하나하나 실행되었다가 꺼진다.
  * docker ps -a에 모두 나오는데 ```docker rm $(docker ps -a -q)``` 를 통해 컨테이너를 삭제한다.
* 도커 실행
  * docker run -it busybox sh
  * exec을 이용하면 중간에 돌아가고 있는 컨테이너에 실행 조건을 붙일 수 있다.

* gshell
  * z 명령어
* sysctl과 systemctl의 차이점???

* 도커 이미지 만들기
  * docker images
  * docker commit + ```컨테이너``` + ```생성하는 이미지 이름```
  * docker tag ```내 아이디/이미지 이름```
  * docker login
  * docker push ```내 아이디/이미지 이름```
  * docker pull
* Dockerfile로 도커 이미지 만들기
* docker-compose는 yml 문법을 사용하여 이미지를 만든다.
* 추천 도서: 가장 빨리 만나는 Docker

* AWS 설정
  * ```vi ~/aws/credentials```
  * 프로파일 에듀 추가
  * ```aws configure --profile edu```
* Amazon ECR을 활용하면 사설 도커허브를 사용할 수 있다.
  * 도커 이미지(오리진) -> 없으면 도커 허브
  * Application Load Balancer를 활용하여 로드 밸런싱 옵션을 활성화한다.
  * Fargate는 서버리스. 관리형 EC2 위에 컨테이너가 올라가니까 서버 자체를 관리할 필요가 없다.
  * 100개 컨테이너를 띄우면 알아서 수평적 확장이 이루어진다. 단, 관리 비용이 포함되어 조금 비싸다.

## Kubernetes

* 카카오톡에서 도커를 쓰면 몇 개의 컨테이너를 쓸까? 아마 10만개. 이미지는 수백개... 그룹으로 있겠다.