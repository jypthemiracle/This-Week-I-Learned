# 2020.03.02 TIL

## Interesting stuff regarding Linux...

### Shell

* Bourne Shell

  * /bin/sh
  * /bin/ksh
  * /bin/bash - 맥의 기본
  * /bin/zsh - 이게 그 oh-my-zsh라는 것이구나. 강력한 히스토리 기능

* C Shell

  * /bin/csh - 윈도우
  * /bin/tsch

* 셸 확인하는 방법

  * /etc/sheels: 사용할 수 있는 쉘을 알 수 있음
  * /etc/passwd: 각 계정마다 할당된 쉘을 알 수 있음
  * echo $SHELL: 현재 로그인하고 있는 사용자가 보고 있는 쉘을 알 수 있음

* 셸을 변경하는 방법

  * chsh : chsh [옵션] [계정명] 으로 사용
    * -s(shell) : 앞으로 사용할 로그인 셸로 지정
    * -l(List) : shells 파일안에 지정된 셸을 나열
    * usermod(추가 옵션)
      * -s(shell) : 기존셀에서 새로운 셀로 변경 시 사용

* 환경변수와 지역변수

  * 환경변수: 전체 셸에서 사용 가능하고, 서브 셸에서 상속 받음 (env 명령으로 확인)
  * 지역변수: 로그인 셸에서만 사용 가능하고, 서브 셸에서는 상속 불가능 (set 명령으로 확인)

* 환경변수의 설정

  * export [환경 변수 리스트 확인]
  * export 변수명 = 변수값 [변수값 등록]
  * echo $변수명 [환경 변수값 확인]
  * export 변수명=$변수명:변수값[변수값 추가](시험에서 자주 나옴)
  * uset 변수명 [변수 정의 해제]

* 프롬프트 설정 형식

  * \t (time) : 시간 표시
  * \W (Where) : 현재 작업 디렉터리(마지막 경로)
  * \w (Where) : 현재 작업 디렉터리(절대 경로)
  * \s (shell) : 사용중인 셸 이름
  * \u (user) : 사용자 유저 이름
  * \h (host) : 호스트 이름

* bash 셸 관련 설정 파일들 (전역 설정 파일)

  * /etc/profile : 모든 사용자의 셸 환경을 제어.
    * 관리자만 설정이 가능하며 모든 사용자에게 반영됨

  * /etc/bashrc : alias와 bash가 수행 시 실행되는 함수를 제어
    * 생략되기도 하며 /etc/profile 내용이 포함되기도 함. 지역 설정 파일
    * (~은 home 디렉터리를 뜻함 home 으로 시작하는가 /으로 시작하는가로 구분)

  * ~/.bash_profile : 개인 사용자의 셸 환경을 제어 / 로그인 시 로딩

  * ~/.bash_history : 전에 입력했던 명령어의 재사용이 가능하게 됨

  * ~/.bashrc : alias와 bash가 수행 시 실행되는 함수 제어

  * ~/.bash_logout : 로그아웃 하기 전에 실행되는 파일

* History

  * 사용했던 명령어를 .bash_history에 저장해두고 다시 불러서 사용할 수 있게하는 기능
  * !! : 마지막으로 실행했던 명령문 실행
  * !n : n번째 명령어 실행
  * !-n : 현재 명령어에서 n 개수를 뺀 행의 명령어 실행
  * !문자열 :  최근에 "문자열" 로 시작하는 명령문 실행
  * !?문자열? : 최근에 "문자열" 을 포함하는 단어를 나타냄

* History 관련 환경변수

  * HISTSIZE : 히스토리 스택의 크기 지정 
  * HISTFILE : 히스토리 파일 위치
  * HISTFILESIZE : 물리적인 히스토리 파일 크기
  * HISTTIMEFORMAT : 히스토리 명령어 수행 시간 출력 형태 지정
  * HISTCONTROL : 중복 명령어에 대한 기록 유무 지정

* alias

  * 명령어를 사용하기 쉽게 문자로 입력하고 씀
  * alias 별명 = 명령어 정의 [새로운 별명 정의]
  * unalias 별명 = 지정된 명령어 해제

## 파일 유형 / 파일 허가권

#### 파일 유형

* -: 일반 파일

* d (directory) : 디렉터리 파일

#### 특수 파일 유형

* b (block)  : 블록 장치 특수 파일

* c (character) : 문자 장치 특수 파일

* l (link) : 링크로 바로 가기

* p (pipe) : 파이프

* s (socket) : 소켓

#### 파일 허가권

* rwx / rwx / rwx  각 부분이 User / Group / Owner 을 나타내는데 각 사용자의 권한을 나타낸다.
* rwx는 각각 Read / Write / Excute 의 약어이며 각 읽기 쓰기 실행의 권한을 의미한다.

|        | 일반파일                                       | 디렉터리                                     |
| ------ | ---------------------------------------------- | -------------------------------------------- |
| read   | 파일을 읽을 수 있고 편집은 안되지만복사는 가능 | ls dir 등 디렉터리 내부 읽어오기             |
| write  | rw가 같이있다면 편집 가능w만 있으면 로그만     | mkdir touch rm mv 등 디렉터리 내부 생성/삭제 |
| excute | 실행 (이 권한이 있을경우 응용프로그램)         | 디렉터리에 접근                              |

* 권한이 없을 경우 - 로 표기한다.
* rwx는 각 r=4 / w=2 / x=1 의 8진 숫자로 치환되며 rwxrwxrwx는 777이라는 숫자로도 표현 할 수 있다.

#### Umask

새로 만들어진 파일에 파일 권한을 어떻게 설정할지를 제어하는 마스크 설정을 결정하는 명령어

* 파일 기본 권한 : 666
* 디렉터리의 기본 권한 : 777
* Umask 002: 디폴트 파일 권한 : 664 / 디폴트 디렉터리 권한 : 775
* 보안이 좋은 Umask 007: 소유자를 제외하고 접근 불가
* Umask 077:  디폴트 파일 권한 :600 / 디폴트 디렉터리 권한 700

* -s : Umask 값을 문자로 표기하는 옵션

#### 퍼미션 변경[chmod]

* 8진수 형식
  * chmod 111 dir  > 파일 퍼미션이 --x--x--x 으로 바뀜

* 문자 형식
  * chmod u+rwx g+x o+x dir > 파일 퍼미션이 rwx--x--x 으로 바뀜
  * 사용자 : u(user), g(group), o(owner), a(all) | 연산자 : +(설정), -(제거), =(허가권 지정)   

* 특수 권한
  * setUID:4000, setGID:2000, Stiky bit:1000으로, 섞어 쓸 수 있음. 
  * 6000, 3000 5000 등이 있다.
  * sticky bit로 설정되는 디렉터리는 /tmp 안에 생성한다

* 특별 형식
  * 특별형식1.  u+s[Set-UID], g+s[Set-GID], o+t[Sticky bit]

* 옵션
  * -c : 변경된 파일만 자세하게 보여준다.
  * -f : 변경되지 않은 파일에 대해서 오류 메시지를 보여주지 않는다.
  * -v : 작업상태를 자세히 보여준다.
  * -R : 경로와 그 하위 파일들을 모두 변경한다.

## Reference

https://devcraft.tistory.com/51